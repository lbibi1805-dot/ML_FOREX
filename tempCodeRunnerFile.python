def handle_missing_values(data):
    data.interpolate(method='linear', inplace=True)
    if data.isna().sum().sum() > 0:
        data.ffill(inplace=True)
        if data.isna().sum().sum() > 0:
            data.bfill(inplace=True)
    return data.dropna(subset=['Close', 'Open'])